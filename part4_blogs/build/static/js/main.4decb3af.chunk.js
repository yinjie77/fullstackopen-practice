(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{92:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(20),c=n.n(a),s=n(6),i=n.n(s),o=n(7),u=n(9),l=n(12),j=n(95),d=n(11),b=n(1),p=function(){var e=Object(l.c)((function(e){return e.blogs}));return e.sort((function(e,t){return e.likes>t.likes?-1:1})),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{children:"\u4ee5\u4e0b\u535a\u5ba2\u6309\u7167\u70b9\u8d5e\u6b21\u6570\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f"}),Object(b.jsx)(j.a,{children:Object(b.jsx)("tbody",{children:e.map((function(e){return Object(b.jsx)("tr",{children:Object(b.jsx)("td",{children:Object(b.jsx)(d.b,{to:"/blogs/".concat(e.id),children:e.title})})},e.id)}))})})]})},h=n(17),O=n.n(h),f="/api/blogs",x=null,v=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,O.a.post(f,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,O.a.patch("".concat(f,"/").concat(t.id),{likes:t.likes},n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,O.a.delete("".concat(f,"/").concat(t.id),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("".concat(f,"/").concat(n,"/comments"),{comment:t});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y={getAll:function(){return O.a.get(f).then((function(e){return e.data}))},create:v,setToken:function(e){x="bearer ".concat(e)},updateBlog:g,removeBlog:m,makeComment:w},k=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S={login:k},C=function(e){return{type:"ADD_USER",data:{user:e}}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"ADD_USER"===t.type?t.data.user:e},I=0,E=function(e,t){return function(){var n=Object(o.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:clearTimeout(I),I=setTimeout((function(){return r({type:"SHOW_NOTIFICATION",data:{notification:null}})}),3e3),r({type:"SHOW_NOTIFICATION",data:{message:e,className:t}});case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"SHOW_NOTIFICATION"===t.type?t.data:e},B=n(97),D=n(96),_=function(){var e=Object(l.b)(),t=Object(r.useState)(""),n=Object(u.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),j=Object(u.a)(s,2),d=j[0],p=j[1],h=function(){var t=Object(o.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,S.login({username:a,password:d});case 4:r=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),y.setToken(r.token),e(C(r)),c(""),p(""),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("aaa"),e(E("wrong username or password(maybe the mongo is down)","danger"));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(B.a,{onSubmit:h,children:[Object(b.jsx)(B.a.Group,{children:Object(b.jsx)(B.a.Control,{placeholder:"username",id:"loginusername",type:"text",value:a,name:"usename",onChange:function(e){var t=e.target;c(t.value)}})}),Object(b.jsx)(B.a.Group,{children:Object(b.jsx)(B.a.Control,{placeholder:"password",id:"loginpassword",type:"password",value:d,name:"password",onChange:function(e){var t=e.target;p(t.value)}})}),Object(b.jsx)(D.a,{id:"loginbutton",type:"submit",children:"login"})]})})},N=function(e){var t=e.createBlog,n=Object(r.useState)(""),a=Object(u.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),l=o[0],j=o[1],d=Object(r.useState)(""),p=Object(u.a)(d,2),h=p[0],O=p[1];return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:l,url:h},c),s(""),j(""),O("")},children:[Object(b.jsxs)("div",{children:["title:",Object(b.jsx)("input",{id:"title",value:c,onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(b.jsxs)("div",{children:["author:",Object(b.jsx)("input",{id:"author",value:l,onChange:function(e){var t=e.target;return j(t.value)}})]}),Object(b.jsxs)("div",{children:["url:",Object(b.jsx)("input",{id:"url",value:h,onChange:function(e){var t=e.target;return O(t.value)}})]}),Object(b.jsx)("button",{id:"create",children:"create"})]})})},T=n(100),G=function(){var e=Object(l.c)((function(e){return e.notification})),t=e.message,n=e.className;return null===t?null:Object(b.jsx)("div",{children:t&&Object(b.jsx)(T.a,{variant:n,children:t})})},R=function(e){var t=Object(r.useState)(!1),n=Object(u.a)(t,2),a=n[0],c=n[1],s={display:a?"none":""},i={display:a?"":"none"},o=function(){c(!a)};return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:s,children:Object(b.jsx)("button",{onClick:o,children:e.buttonLabel})}),Object(b.jsxs)("div",{style:i,children:[e.children,Object(b.jsx)("button",{onClick:o,children:"cancel"})]})]})},U=function(e){var t=e.users;return Object(b.jsxs)("div",{children:[Object(b.jsx)("br",{}),Object(b.jsx)("h2",{children:"User Information Statistics"}),t.map((function(e){return Object(b.jsxs)("div",{children:[Object(b.jsx)(d.b,{to:"/users/".concat(e.id),children:e.name}),"has ",e.blogs.length," blogs ,you can click the name to see details"]})}))]})},M=function(e){var t=e.user;return t?Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:t.name}),Object(b.jsx)("h3",{children:"Added blogs"}),t.blogs.map((function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(d.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))]}):null},F=n(8),J=n(44),K=n(58),W=function(e){return function(){var t=Object(o.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.removeBlog({id:e});case 2:n({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INI_BLOG":return t.data.blogs;case"ADD_BLOG":return[].concat(Object(K.a)(e),[t.data.blog]);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?Object(J.a)(Object(J.a)({},e),{},{likes:t.data.likes}):e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));case"MAKE_COMMENT":return e.map((function(e){return e.id===t.data.blog.id?t.data.blog:e}));default:return e}},H=function(e){var t=e.handleLikes,n=e.handleRemoving,a=Object(l.b)(),c=Object(l.c)((function(e){return e.blogs})),s=Object(F.f)().id,j=c.find((function(e){return e.id===s})),d=Object(r.useState)(""),p=Object(u.a)(d,2),h=p[0],O=p[1],f=function(e,t){e.preventDefault(),a(function(e,t){return function(){var n=Object(o.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.makeComment(e,t);case 2:a=n.sent,r({type:"MAKE_COMMENT",data:{blog:a}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(h,t)),O("")};return j?(console.log(j.comments),Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:j.title}),Object(b.jsxs)("div",{children:[Object(b.jsx)("a",{href:j.url,target:"_blank",children:j.url}),Object(b.jsxs)("p",{children:[j.likes,Object(b.jsx)("button",{onClick:function(){return t(j.id,j.likes)},children:"like"})]}),Object(b.jsx)("p",{children:"added by ".concat(j.author)}),Object(b.jsx)("button",{onClick:function(){return n(j)},children:"delete this blog"}),Object(b.jsx)("div",{children:"(only user can do this,If you're any other user, it doesn't matter how many times you click)"})]}),Object(b.jsx)("h3",{children:"comments"}),Object(b.jsxs)("form",{onSubmit:function(e){return f(e,j.id)},children:[Object(b.jsx)("input",{type:"text",value:h,onChange:function(e){return O(e.target.value)}})," ",Object(b.jsx)("button",{children:"add comments"})]}),Object(b.jsx)("ul",{children:j.comments.map((function(e){return Object(b.jsx)("li",{children:e})}))})]})):null},q="/api/users",P=function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get(q);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post(q,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V={getALL:P,register:Q},X=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),s=Object(u.a)(c,2),l=s[0],j=s[1],d=Object(r.useState)(""),p=Object(u.a)(d,2),h=p[0],O=p[1],f=function(){var e=Object(o.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,V.register({username:n,name:l,password:h});case 4:r=e.sent,console.log(r),a(""),j(""),O(""),alert("\u4f60\u5df2\u7ecf\u6ce8\u518c\u6210\u529f"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),alert("username\u5df2\u7ecf\u5b58\u5728\uff0c\u8bf7\u6362\u4e00\u4e2a");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)("div",{children:Object(b.jsxs)(B.a,{onSubmit:f,children:[Object(b.jsx)(B.a.Group,{children:Object(b.jsx)(B.a.Control,{placeholder:"username \uff08\u6b64\u680f\u7684\u503c\u5728\u6570\u636e\u5e93\u4e2d\u552f\u4e00\uff0c\u5982\u679c\u4e0d\u884c\u591a\u8bd5\u51e0\u4e2a\uff09",type:"text",value:n,onChange:function(e){var t=e.target;a(t.value)}})}),Object(b.jsx)(B.a.Group,{children:Object(b.jsx)(B.a.Control,{placeholder:"name",type:"text",value:l,onChange:function(e){var t=e.target;j(t.value)}})}),Object(b.jsx)(B.a.Group,{children:Object(b.jsx)(B.a.Control,{placeholder:"password",type:"password",value:h,onChange:function(e){var t=e.target;O(t.value)}})}),Object(b.jsx)(D.a,{type:"submit",children:"registered"})]})})},Y=function(e){return{type:"ADD_USERS",data:{users:e}}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"ADD_USERS"===t.type?t.data.users:e},$=n(99),ee=n(98),te=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.loggedUser})),n=Object(r.useState)([]),a=Object(u.a)(n,2),c=a[0],s=a[1],j=Object(F.g)("/users/:id");console.log("a"+j);var h=j?c.find((function(e){return e.id===j.params.id})):null;Object(r.useEffect)((function(){e(function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:n=e.sent,t({type:"INI_BLOG",data:{blogs:n}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(r.useEffect)((function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e(C(n)),y.setToken(n.token)}}),[e]),Object(r.useEffect)((function(){Object(o.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V.getALL();case 2:n=t.sent,e(Y(n)),s(n);case 5:case"end":return t.stop()}}),t)})))()}),[e]);var O=function(n,r){e(function(e){return function(){var t=Object(o.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.create(e);case 2:r=t.sent,n({type:"ADD_BLOG",data:{blog:r}});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(n)),e(E("a new blog ".concat(r," ! by ").concat(t.username),"success"))},f=function(){var t=Object(o.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.confirm("Remove ".concat(n.title," by ").concat(n.author)))try{e(W(n.id))}catch(r){e(E("error","danger"))}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x={padding:10};return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsxs)("div",{children:[Object(b.jsxs)($.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:[Object(b.jsx)($.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(b.jsx)($.a.Collapse,{id:"responsive-navbar-nav",children:Object(b.jsxs)(ee.a,{className:"mr-auto",children:[Object(b.jsx)(ee.a.Link,{href:"#",as:"span",children:Object(b.jsx)(d.b,{style:x,to:"/blogs",children:"blogs"})}),Object(b.jsx)(ee.a.Link,{href:"#",as:"span",children:Object(b.jsx)(d.b,{style:x,to:"/users",children:"users"})}),Object(b.jsx)(ee.a.Link,{href:"#",as:"span",children:t?Object(b.jsxs)("em",{children:[t.username," logged in"]}):Object(b.jsxs)("em",{children:[Object(b.jsx)(d.b,{style:x,to:"/login",children:"login"}),"  ",Object(b.jsx)(d.b,{style:x,to:"/Register",children:"Register"})]})})]})})]}),t&&Object(b.jsxs)("span",{children:[" ",Object(b.jsx)("button",{onClick:function(){window.localStorage.getItem("loggedBlogappUser")&&(window.localStorage.removeItem("loggedBlogappUser"),e(C(null)))},className:"login-out",children:"logout"})," "]})]}),Object(b.jsx)(G,{}),null===t?Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"log in to application"}),Object(b.jsxs)(F.c,{children:[Object(b.jsx)(F.a,{path:"/Register",children:Object(b.jsx)(X,{})}),Object(b.jsx)(F.a,{path:"/",children:Object(b.jsx)(_,{})})]})]}):Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"blogs \uff08\u6b64\u535a\u5ba2\u4ec5\u4f9b\u7528\u6237\u4e0a\u4f20\u7528\u6237\u8ba4\u4e3a\u6709\u4ef7\u503c\u7684\u6587\u7ae0\u4e0e\u8d44\u6599\uff09"}),Object(b.jsxs)(F.c,{children:[Object(b.jsx)(F.a,{path:"/users/:id",children:Object(b.jsx)(M,{user:h})}),Object(b.jsx)(F.a,{path:"/users",children:Object(b.jsx)(U,{users:c})}),Object(b.jsx)(F.a,{path:"/blogs/:id",children:Object(b.jsx)(H,{handleLikes:function(t,n){e(function(e,t){return function(){var n=Object(o.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.updateBlog({id:e,likes:t});case 2:r({type:"LIKE_BLOG",data:{id:e,likes:t}});case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n+1))},handleRemoving:f})}),Object(b.jsxs)(F.a,{path:"/",children:[Object(b.jsx)(R,{buttonLabel:"create new blog",children:Object(b.jsx)(N,{createBlog:O})}),Object(b.jsx)(p,{})]})]})]})]})},ne=(n(92),n(56)),re=n(57),ae=n(30),ce=Object(ae.combineReducers)({blogs:z,loggedUser:L,users:Z,notification:A}),se=Object(ae.createStore)(ce,Object(re.composeWithDevTools)(Object(ae.applyMiddleware)(ne.a)));c.a.render(Object(b.jsx)(d.a,{children:Object(b.jsx)(l.a,{store:se,children:Object(b.jsx)(te,{})})}),document.getElementById("root"))}},[[93,1,2]]]);
//# sourceMappingURL=main.4decb3af.chunk.js.map